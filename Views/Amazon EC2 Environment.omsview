{
    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "location": {
            "type": "string",
            "defaultValue": ""
        },
        "resourcegroup": {
            "type": "string",
            "defaultValue": ""
        },
        "subscriptionId": {
            "type": "string",
            "defaultValue": ""
        },
        "workspace": {
            "type": "string",
            "defaultValue": ""
        },
        "workspaceapiversion": {
            "type": "string",
            "defaultValue": ""
        }
    },
    "resources": [
        {
            "apiVersion": "[parameters('workspaceapiversion')]",
            "name": "[parameters('workspace')]",
            "type": "Microsoft.OperationalInsights/workspaces",
            "location": "[parameters('location')]",
            "id": "[Concat('/subscriptions/', parameters('subscriptionId'), '/resourceGroups/', parameters('resourcegroup'), '/providers/Microsoft.OperationalInsights/workspaces/', parameters('workspace'))]",
            "resources": [
                {
                    "apiVersion": "2015-11-01-preview",
                    "name": "Amazon EC2 Environment",
                    "type": "views",
                    "location": "[parameters('location')]",
                    "id": "[Concat('/subscriptions/', parameters('subscriptionId'), '/resourceGroups/', parameters('resourcegroup'), '/providers/Microsoft.OperationalInsights/workspaces/', parameters('workspace'),'/views/Amazon EC2 Environment')]",
                    "dependson": [
                        "[Concat('/subscriptions/', parameters('subscriptionId'), '/resourceGroups/', parameters('resourcegroup'), '/providers/Microsoft.OperationalInsights/workspaces/', parameters('workspace'))]"
                    ],
                    "properties": {
                        "Id": "Amazon EC2 Environment",
                        "Name": "Amazon EC2 Environment",
                        "Author": "service.azure@bluemedora.com",
                        "Source": "Local",
                        "Version": 2,
                        "Dashboard": [
                            {
                                "Id": "InformationBlade",
                                "Type": "Blade",
                                "Version": 0,
                                "Configuration": {
                                    "General": {
                                        "Title": "EC2 Overview",
                                        "NewGroup": false,
                                        "Color": "#dd5900"
                                    },
                                    "Header": {
                                        "Image": "data:image/png;base64,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",
                                        "Label": "Amazon EC2",
                                        "Link": {
                                            "Label": "More info",
                                            "Url": "https://docs.bindplane.bluemedora.com/docs/ec2"
                                        }
                                    },
                                    "List": [
                                        {
                                            "Title": "Overview",
                                            "Content": "Amazon EC2 is a web service that provides secure, resizable compute capacity in the cloud. "
                                        },
                                        {
                                            "Title": "Key Performance Indicators",
                                            "Content": "It is important to monitor CPU usage in Amazon EC2 in order to ensure that an EC2 Instance can meet its workload requirements. \n\nLarger intstances may temporarily exceed their computing power through bursting, which will consume CPU credits.\n\nIt is also important to track disk I/O and network throughput, as both of these may create potential bottlenecks in processing."
                                        }
                                    ]
                                }
                            },
                            {
                                "Id": "LineChartCalloutStackedBuilderBlade",
                                "Type": "Blade",
                                "Version": 0,
                                "Configuration": {
                                    "General": {
                                        "title": "EC2 CPU Usage",
                                        "newGroup": false
                                    },
                                    "charts": [
                                        {
                                            "Header": {
                                                "Title": "CPU Utilization",
                                                "Subtitle": ""
                                            },
                                            "LineChart": {
                                                "Query": "amazon_ec2_instance_CL | where ${Instance} and ${Image} | extend cpu=iif(isnull(cpu_utilization_d), 0.0, cpu_utilization_d) | summarize avg(cpu) by amazon_ec2_instance_name_s",
                                                "yAxis": {
                                                    "isLogarithmic": false,
                                                    "units": {
                                                        "baseUnitType": "Percentage",
                                                        "baseUnit": "ZeroToOne",
                                                        "displayUnit": "ZeroToOne"
                                                    },
                                                    "customLabel": "CPU"
                                                },
                                                "NavigationSelect": {}
                                            }
                                        },
                                        {
                                            "Header": {
                                                "Title": "CPU Credit Balance",
                                                "Subtitle": ""
                                            },
                                            "LineChart": {
                                                "Query": "amazon_ec2_instance_CL | where ${Instance} and ${Image} | extend balance=iif(isnull(cpu_credit_balance_d), 0.0, cpu_credit_balance_d) | summarize avg(balance) by amazon_ec2_instance_name_s",
                                                "yAxis": {
                                                    "isLogarithmic": false,
                                                    "units": {
                                                        "baseUnitType": "",
                                                        "baseUnit": "",
                                                        "displayUnit": ""
                                                    },
                                                    "customLabel": "Credits"
                                                },
                                                "NavigationSelect": {}
                                            }
                                        },
                                        {
                                            "Header": {
                                                "Title": "CPU Credit Usage",
                                                "Subtitle": ""
                                            },
                                            "LineChart": {
                                                "Query": "amazon_ec2_instance_CL | where ${Instance} and ${Image} | extend usage=iif(isnull(cpu_credit_usage_d), 0.0, cpu_credit_usage_d) | summarize avg(usage) by amazon_ec2_instance_name_s",
                                                "yAxis": {
                                                    "isLogarithmic": false,
                                                    "units": {
                                                        "baseUnitType": "",
                                                        "baseUnit": "",
                                                        "displayUnit": ""
                                                    },
                                                    "customLabel": "Credits"
                                                },
                                                "NavigationSelect": {}
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "Id": "LineChartCalloutBuilderBlade",
                                "Type": "Blade",
                                "Version": 0,
                                "Configuration": {
                                    "General": {
                                        "title": "EC2 Disk I/O",
                                        "newGroup": false,
                                        "icon": "",
                                        "useIcon": false
                                    },
                                    "Header": {
                                        "Title": "Disk I/O",
                                        "Subtitle": ""
                                    },
                                    "LineChart": {
                                        "Query": "amazon_ec2_instance_CL | where ${Instance} and ${Image} | extend disk_write=iif(isnull(disk_write_ops_d), 0.0, disk_write_ops_d), disk_read=iif(isnull(disk_read_ops_d), 0.0, disk_read_ops_d)  | summarize avg(disk_write+disk_read) by amazon_ec2_instance_name_s | order by avg_ desc",
                                        "Callout": {
                                            "Title": "Avg per hour",
                                            "Series": "",
                                            "Operation": "Average"
                                        },
                                        "yAxis": {
                                            "isLogarithmic": false,
                                            "units": {
                                                "baseUnitType": "",
                                                "baseUnit": "",
                                                "displayUnit": ""
                                            },
                                            "customLabel": "I/O"
                                        },
                                        "NavigationSelect": {}
                                    },
                                    "List": {
                                        "Query": "amazon_ec2_instance_CL | where ${Instance} and ${Image} | extend disk_write=iif(isnull(disk_write_ops_d), 0.0, disk_write_ops_d), disk_read=iif(isnull(disk_read_ops_d), 0.0, disk_read_ops_d)  | summarize avg(disk_write+disk_read) by amazon_ec2_instance_name_s | order by avg_ desc",
                                        "HideGraph": false,
                                        "enableSparklines": true,
                                        "operation": "Last Sample",
                                        "ColumnsTitle": {
                                            "Name": "Instance",
                                            "Value": "Disk I/O"
                                        },
                                        "Color": "#0072c6",
                                        "thresholds": {
                                            "isEnabled": false,
                                            "values": [
                                                {
                                                    "name": "Normal",
                                                    "threshold": "Default",
                                                    "color": "#009e49",
                                                    "isDefault": true
                                                },
                                                {
                                                    "name": "Warning",
                                                    "threshold": "60",
                                                    "color": "#fcd116",
                                                    "isDefault": false
                                                },
                                                {
                                                    "name": "Error",
                                                    "threshold": "90",
                                                    "color": "#ba141a",
                                                    "isDefault": false
                                                }
                                            ]
                                        },
                                        "NameDSVSeparator": "",
                                        "NavigationQuery": "search {selected item} | sort by TimeGenerated desc",
                                        "NavigationSelect": {
                                            "NavigationQuery": "search {selected item} | sort by TimeGenerated desc"
                                        }
                                    }
                                }
                            },
                            {
                                "Id": "LineChartCalloutBuilderBlade",
                                "Type": "Blade",
                                "Version": 0,
                                "Configuration": {
                                    "General": {
                                        "title": "EC2 Network",
                                        "newGroup": false,
                                        "icon": "",
                                        "useIcon": false
                                    },
                                    "Header": {
                                        "Title": "Network Throughput",
                                        "Subtitle": ""
                                    },
                                    "LineChart": {
                                        "Query": "amazon_ec2_instance_CL | where ${Instance} and ${Image} | summarize avg(iif(isempty(network_in_d),0.0,network_in_d)+iif(isempty(network_out_d),0.0,network_out_d)) by amazon_ec2_instance_name_s",
                                        "Callout": {
                                            "Title": "Avg per hour",
                                            "Series": "",
                                            "Operation": "Average"
                                        },
                                        "yAxis": {
                                            "isLogarithmic": false,
                                            "units": {
                                                "baseUnitType": "Bits",
                                                "baseUnit": "Bytes",
                                                "displayUnit": "Bytes"
                                            },
                                            "customLabel": "Throughput"
                                        },
                                        "NavigationSelect": {}
                                    },
                                    "List": {
                                        "Query": "amazon_ec2_instance_CL  | where ${Instance} and ${Image} | summarize avg(iif(isempty(network_in_d),0.0,network_in_d)+iif(isempty(network_out_d),0.0,network_out_d)) by amazon_ec2_instance_name_s | order by avg_ desc",
                                        "HideGraph": false,
                                        "enableSparklines": true,
                                        "operation": "Last Sample",
                                        "ColumnsTitle": {
                                            "Name": "Instance",
                                            "Value": "Throughput"
                                        },
                                        "Color": "#0072c6",
                                        "thresholds": {
                                            "isEnabled": false,
                                            "values": [
                                                {
                                                    "name": "Normal",
                                                    "threshold": "Default",
                                                    "color": "#009e49",
                                                    "isDefault": true
                                                },
                                                {
                                                    "name": "Warning",
                                                    "threshold": "60",
                                                    "color": "#fcd116",
                                                    "isDefault": false
                                                },
                                                {
                                                    "name": "Error",
                                                    "threshold": "90",
                                                    "color": "#ba141a",
                                                    "isDefault": false
                                                }
                                            ]
                                        },
                                        "NameDSVSeparator": "",
                                        "NavigationQuery": "search {selected item} | sort by TimeGenerated desc",
                                        "NavigationSelect": {
                                            "NavigationQuery": "search {selected item} | sort by TimeGenerated desc"
                                        }
                                    }
                                }
                            },
                            {
                                "Id": "NotableQueriesBuilderBlade",
                                "Type": "Blade",
                                "Version": 0,
                                "Configuration": {
                                    "General": {
                                        "title": "Additional Info",
                                        "newGroup": false,
                                        "preselectedFilters": "Type, Computer",
                                        "renderMode": "grid"
                                    },
                                    "queries": [
                                        {
                                            "query": "amazon_ec2_instance_CL | summarize avg(network_packets_in_average_d), avg(network_packets_out_average_d) by amazon_ec2_instance_name_s | render barchart",
                                            "displayName": "Instance Network Throughput"
                                        },
                                        {
                                            "query": "amazon_ec2_instance_CL | join kind= inner (     amazon_ec2_instance_CL     | summarize TimeGenerated=max(TimeGenerated) by amazon_ec2_instance_name_s ) on TimeGenerated, amazon_ec2_instance_name_s | project amazon_ec2_instance_name_s, architecture_s, hypervisor_s, domain_s, ip_address_s, public_dns_name_s, virtualization_type_s",
                                            "displayName": "Instance Configuration"
                                        },
                                        {
                                            "query": "amazon_ec2_instance_CL | join kind= inner (     amazon_ec2_instance_CL     | summarize TimeGenerated=max(TimeGenerated) by amazon_ec2_instance_name_s ) on TimeGenerated, amazon_ec2_instance_name_s | project amazon_ec2_instance_name_s, status_s, system_status_s",
                                            "displayName": "Instance Status"
                                        },
                                        {
                                            "query": "amazon_ec2_instance_CL | join kind= inner (     amazon_ec2_instance_CL     | summarize TimeGenerated=max(TimeGenerated) by amazon_ec2_instance_name_s ) on TimeGenerated, amazon_ec2_instance_name_s | project amazon_ec2_instance_name_s, cpu_surplus_credits_charged_d, cpu_surplus_credit_balance_d ",
                                            "displayName": "Instance CPU Surplus"
                                        },
                                        {
                                            "query": "amazon_ec2_instance_CL | where status_check_failed_d != 0 and isnotnull(status_check_failed_d) | project amazon_ec2_instance_name_s, status_check_failed_d, status_check_failed_instance_d, status_check_failed_system_d",
                                            "displayName": "Instance Failed Checks"
                                        }
                                    ]
                                }
                            }
                        ],
                        "Filters": [
                            {
                                "FieldName": "amazon_ec2_instance_name_s",
                                "QueryForValues": "amazon_ec2_instance_CL | distinct amazon_ec2_instance_name_s",
                                "Title": "Instance"
                            },
                            {
                                "FieldName": "amazon_ec2_image_name_s",
                                "QueryForValues": "amazon_ec2_image_CL | distinct amazon_ec2_image_name_s",
                                "Title": "Image"
                            }
                        ],
                        "OverviewTile": {
                            "Id": "LineChartCalloutBuilderTile",
                            "Type": "OverviewTile",
                            "Version": 2,
                            "Configuration": {
                                "LineChart": {
                                    "Query": "amazon_ec2_instance_CL | extend cpu=iif(isnull(cpu_utilization_d), 0.0, cpu_utilization_d) | summarize avg(cpu) by amazon_ec2_instance_name_s",
                                    "Callout": {
                                        "Title": "Average CPU",
                                        "Series": "",
                                        "Operation": "Average"
                                    },
                                    "yAxis": {
                                        "isLogarithmic": false,
                                        "units": {
                                            "baseUnitType": "Percentage",
                                            "baseUnit": "ZeroToOne",
                                            "displayUnit": "ZeroToOne"
                                        },
                                        "customLabel": "CPU"
                                    }
                                },
                                "Advanced": {
                                    "DataFlowVerification": {
                                        "Enabled": false,
                                        "Query": "search * | limit 1 | project TimeGenerated",
                                        "Message": ""
                                    }
                                }
                            }
                        }
                    }
                }
            ]
        }
    ]
}